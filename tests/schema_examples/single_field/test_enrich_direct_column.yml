# Test enrichment that writes directly to source table column
database: placeholder  # Will be replaced by test runner
default_model: gpt-4o-mini

sql_queries:
  all_docs: |
    SELECT rowid, sha1, * FROM documents
    ORDER BY rowid

enrichments:
  - name: extract_year
    description: "Extract year from document content"
    model: gpt-4o-mini
    input:
      query: all_docs
      input_columns: ["raw_content"]
    schema:
      doc_year: {type: "integer", minimum: 1900, maximum: 2100}
    prompt: |
      Extract the year mentioned in this document.
      Return only the 4-digit year as an integer.